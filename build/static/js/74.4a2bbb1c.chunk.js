"use strict";(self.webpackChunkPicka_a=self.webpackChunkPicka_a||[]).push([[74,137],{9550:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(5671),o=n(3144),a=n(136),i=n(8557),s=n(8381),c=n.n(s),l=n(1127),u=n(4393),d=n(2461),p=n(4446),g=n.n(p),m=function(e){(0,a.Z)(n,e);var t=(0,i.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={gpsAccessError:!1,lat:null,lng:null},e.__sendGpsLocation=function(t){e.props.sendDeliveryGuyGpsLocation(e.props.delivery_user.data.auth_token,e.props.delivery_user.data.id,t.coords.latitude,t.coords.longitude,t.coords.heading)},e}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=navigator&&navigator.geolocation;t&&(this.refreshSetInterval=setInterval((function(){t.getCurrentPosition((function(t){e.__sendGpsLocation(t)}),(function(t){"PickaAndroidWebViewUA"===navigator.userAgent&&"undefined"!==window.Android?e.setState({gpsAccessError:!1}):(console.log("Inside error"),console.log(t),e.setState({gpsAccessError:!0}))}),{enableHighAccuracy:!0})}),15e3))}},{key:"componentWillUnmount",value:function(){clearInterval(this.refreshSetInterval),console.log("Cleared API CALL")}},{key:"render",value:function(){return c().createElement(c().Fragment,null,c().createElement("div",{className:"pt-50"},this.state.gpsAccessError&&c().createElement("div",{className:"auth-error location-error",style:{bottom:"5rem"}},c().createElement("div",{className:"error-shake"},localStorage.getItem("allowLocationAccessMessage")))))}}]),n}(s.Component),f=(0,l.$j)((function(e){return{delivery_user:e.delivery_user.delivery_user}}),{sendDeliveryGuyGpsLocation:function(e,t,n,r,o){return function(a){g().post(d.S7,{token:e,user_id:t,delivery_lat:n,delivery_long:r,heading:o}).then((function(e){var t=e.data;return a({type:u.S,payload:t})})).catch((function(e){console.log(e)}))}}})(m)},4060:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var r,o=n(4165),a=n(5861),i=n(5671),s=n(3144),c=n(136),l=n(8557),u=n(4882),d=n(8381),p=n.n(d),g=n(1722),m=n(8891),f=n(6244),v=n(1127);n(8892);u.Z.messaging.isSupported()&&("null"!==localStorage.getItem("firebasePublic")&&"null"!==localStorage.getItem("firebaseSenderId")&&null!==localStorage.getItem("firebasePublic")&&null!==localStorage.getItem("firebaseSenderId")?(r=u.Z.initializeApp({apiKey:"AIzaSyAblW7PktcZysn0p1qUMsxqK1S1ojSub2c",authDomain:"spheric-alcove-356502.firebaseapp.com",projectId:"spheric-alcove-356502",storageBucket:"spheric-alcove-356502.appspot.com",messagingSenderId:"215093171592",appId:"1:215093171592:web:f375828539dfc479b7163d",measurementId:"G-W11PFT24TM"}).messaging()).usePublicVapidKey(localStorage.getItem("firebasePublic")):(r=u.Z.initializeApp({apiKey:"AIzaSyAblW7PktcZysn0p1qUMsxqK1S1ojSub2c",authDomain:"spheric-alcove-356502.firebaseapp.com",projectId:"spheric-alcove-356502",storageBucket:"spheric-alcove-356502.appspot.com",messagingSenderId:"215093171592",appId:"1:215093171592:web:f375828539dfc479b7163d",measurementId:"G-W11PFT24TM"}).messaging()).usePublicVapidKey("BH5L8XrGsNpki5uF1008FbZzgKKZN-NmhOwdWL5Lxh5r3nsgZ6N_Dged1IYXXCCJwpnrXzs52G_v3vM_naO0hxY"));var y=r,h=n(6172),b=n(2461),S=n(4446),k=n.n(S),I=n(9550),Z=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"render",value:function(){return p().createElement(p().Fragment,null,p().createElement("div",{className:"content-center text-center text-muted font-w600"},p().createElement("div",null,p().createElement("i",{className:"si si-screen-smartphone mb-2",style:{fontSize:"4rem",opacity:"0.5"}})),p().createElement("div",null,localStorage.getItem("deliveryUsePhoneToAccessMsg"))))}}]),n}(d.Component),w=Z,_=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelector("#mainManifest")&&document.querySelector("#mainManifest").setAttribute("href","/delivery-manifest.json"),document.getElementsByTagName("body")&&(document.getElementsByTagName("body")[0].classList.remove("bg-grey"),document.getElementsByTagName("body")[0].classList.add("delivery-dark-bg")),(t=this.props.delivery_user).success&&u.Z.messaging.isSupported()&&(n=this.props.saveNotificationToken,y.requestPermission().then((0,a.Z)((0,o.Z)().mark((function e(){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getToken();case 2:r=e.sent,n(r,t.data.id,t.data.auth_token);case 4:case"end":return e.stop()}}),e)})))).catch((function(e){console.log("Unable to get permission to notify.",e)})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return window.innerWidth>768?p().createElement(w,null):this.props.delivery_user.success?p().createElement(p().Fragment,null,p().createElement(g.Z,{seotitle:"Delivery Orders",seodescription:localStorage.getItem("seoMetaDescription"),ogtype:"website",ogtitle:localStorage.getItem("seoOgTitle"),ogdescription:localStorage.getItem("seoOgDescription"),ogurl:window.location.href,twittertitle:localStorage.getItem("seoTwitterTitle"),twitterdescription:localStorage.getItem("seoTwitterDescription")}),p().createElement(m.default,null),"PickaAndroidWebViewUA"!==navigator.userAgent&&p().createElement(I.Z,null)):p().createElement(f.Z,{to:"/login"})}}]),n}(d.Component),A=(0,v.$j)((function(e){return{delivery_user:e.delivery_user.delivery_user}}),{saveNotificationToken:function(e,t,n){return function(r){k().post(b.aD,{push_token:e,user_id:t,token:n}).then((function(e){e.data&&console.log("Notification Token Saved");var t=e.data;return r({type:h.m,payload:t})})).catch((function(e){console.log(e)}))}}})(_)}}]);
//# sourceMappingURL=74.4a2bbb1c.chunk.js.map